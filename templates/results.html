<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Choose Your Items</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="container">
  <h1>Select Your Items & Splits</h1>

  {% if note %}
    <div class="note">{{ note }}</div>
  {% endif %}

  <form action="/split" method="post">
    <table>
      <thead>
        <tr>
          <th>Pick</th>
          <th>Item</th>
          <th class="right">Price</th>
          <th>Split among (people)</th>
        </tr>
      </thead>

      <tbody>
        {% for item in items %}
        <tr>
          <td>
            <input type="checkbox"
                   name="chosen"
                   value="{{ loop.index0 }}"
                   {% if selected and (loop.index0|string) in selected %}checked{% endif %}>
          </td>
          <td>{{ item.name }}</td>
          <td class="right">{{ "%.2f"|format(item.price) }}</td>
          <td>
            <input type="number" name="split_{{ loop.index0 }}" value="1" min="1">
          </td>

          <input type="hidden" name="name_{{ loop.index0 }}" value="{{ item.name }}">
          <input type="hidden" name="price_{{ loop.index0 }}" value="{{ item.price }}">
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <input type="hidden" name="total_rows" value="{{ items|length }}">

    <button type="submit">Compute My Total</button>
    <a href="/" class="footer-link">Upload another</a>
  </form>

  {% if breakdown %}
    <hr>
    <h2>Your Breakdown</h2>

    <table>
      <thead>
        <tr>
          <th>Item</th>
          <th class="right">Item Price</th>
          <th>Split Among</th>
          <th class="right">Your Share</th>
        </tr>
      </thead>

      <tbody>
        {% for row in breakdown %}
        <tr>
          <td>{{ row.name }}</td>
          <td class="right">{{ "%.2f"|format(row.price) }}</td>
          <td>{{ row.split_n }}</td>
          <td class="right"><strong>{{ "%.2f"|format(row.your_share) }}</strong></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <h3>Total You Pay: {{ "%.2f"|format(total_share) }}</h3>
  {% endif %}
</div>

</body>
</html>
